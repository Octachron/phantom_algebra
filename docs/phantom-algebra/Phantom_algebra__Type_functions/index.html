<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Phantom_algebra__Type_functions (phantom-algebra.Phantom_algebra__Type_functions)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">phantom-algebra</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Phantom_algebra__Type_functions</span></h1></header><p>Type-level functions</p><p>Skim through this section when reading the documentation
for the first (second, third and â€¦) time</p><h3>Small integer type representation</h3><div class="spec type" id="type-z"><a href="#type-z" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a z</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-z.zero" class="anchored"><td class="def constructor"><a href="#type-z.zero" class="anchor"></a><code><span class="keyword">| </span></code><code>`zero<span class="keyword"> of </span><span class="type-var">'a</span></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-one"><a href="#type-one" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a one</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-one.one" class="anchored"><td class="def constructor"><a href="#type-one.one" class="anchor"></a><code><span class="keyword">| </span></code><code>`one<span class="keyword"> of </span><span class="type-var">'a</span></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-two"><a href="#type-two" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a two</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-two.two" class="anchored"><td class="def constructor"><a href="#type-two.two" class="anchor"></a><code><span class="keyword">| </span></code><code>`two<span class="keyword"> of </span><span class="type-var">'a</span></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-three"><a href="#type-three" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a three</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-three.three" class="anchored"><td class="def constructor"><a href="#type-three.three" class="anchor"></a><code><span class="keyword">| </span></code><code>`three<span class="keyword"> of </span><span class="type-var">'a</span></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-four"><a href="#type-four" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a four</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-four.four" class="anchored"><td class="def constructor"><a href="#type-four.four" class="anchor"></a><code><span class="keyword">| </span></code><code>`four<span class="keyword"> of </span><span class="type-var">'a</span></code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-any"><a href="#type-any" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('a, 'b, 'c) any</code><code><span class="keyword"> = </span>[&lt; `zero of <span class="type-var">'b</span> * <span class="type-var">'a</span> | `one of <span class="type-var">'b</span> * <span class="type-var">'a</span> | `two of <span class="type-var">'b</span> * <span class="type-var">'a</span> ]<span class="keyword"> as </span>c</code><code></code></div><div class="doc"></div></div><h3>Type-level functions</h3><div class="spec type" id="type-product"><a href="#type-product" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('rank1, 'rank2, 'rank3, 'dim1, 'dim2, 'dim3, 'parameters) product</code><code><span class="keyword"> = </span>[&lt; `zero of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-z">z</a><span class="keyword"> * </span><span class="type-var">'p2</span> <a href="index.html#type-one">one</a> | `one of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim2</span> | `two of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'dim2</span> ] | `one of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim2</span> | `one of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim2</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim1</span> | `two of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim2</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim1</span> ] | `two of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'dim2</span> | `one of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim2</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim1</span> | `two of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim2</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim1</span> ] ]<span class="keyword"> as </span>rank1</code><code><span class="keyword"> constraint </span><span class="type-var">'parameters</span> = <span class="type-var">'p1</span><span class="keyword"> * </span><span class="type-var">'p2</span><span class="keyword"> * </span><span class="type-var">'p3</span></code></div><div class="doc"><p><code class="code">(x,y,z,d1,d2,d3_ ) product</code> computes the types of (x,d1) * (y,d2= and
put the result inside z and d3.
In practice, the aims is to direct the unification of the type variables
using the type values of the inputs.
For the product we have the following types
<code class="code">(''dim1, 'rank1) t -&gt; ('dim2,'rank2) t -&gt; ('dim3, 'rank3) t </code>
and we want to unify <code class="code">'rank3</code> and <code class="code">'dim3</code> with the right values</p></div></div><div class="spec type" id="type-div"><a href="#type-div" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('rank1, 'rank2, 'rank3, 'dim1, 'dim2, 'dim3, 'parameters) div</code><code><span class="keyword"> = </span>[&lt; `zero of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-z">z</a><span class="keyword"> * </span><span class="type-var">'p2</span> <a href="index.html#type-one">one</a> ] | `one of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim1</span> | `one of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim2</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim1</span> | `two of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim2</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim1</span> ] | `two of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'dim1</span> | `two of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim2</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p2</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim1</span> ] ]<span class="keyword"> as </span>rank1</code><code><span class="keyword"> constraint </span><span class="type-var">'parameters</span> = <span class="type-var">'p1</span><span class="keyword"> * </span><span class="type-var">'p2</span><span class="keyword"> * </span><span class="type-var">'p3</span></code></div><div class="doc"><p>(x,y,z,_ ) div computes the rank of x * y and
put the result inside z</p></div></div><div class="spec type" id="type-rank_diff"><a href="#type-rank_diff" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('rank1, 'rank2, 'rank3, 'parameters) rank_diff</code><code><span class="keyword"> = </span>[&lt; `one of <span class="type-var">'rank2</span> * [&lt; `one of <span class="type-var">'rank3</span> * <span class="type-var">'p1</span> <a href="index.html#type-z">z</a> ] | `two of <span class="type-var">'rank2</span> * [&lt; `one of <span class="type-var">'rank3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a> | `two of <span class="type-var">'rank3</span> * <span class="type-var">'p1</span> <a href="index.html#type-z">z</a> ] ]<span class="keyword"> as </span>rank1</code><code><span class="keyword"> constraint </span><span class="type-var">'parameters</span> = <span class="type-var">'p1</span></code></div><div class="doc"><p>(x,y,z,_ ) diff computes the rank of x - y and
put the result inside z</p></div></div><div class="spec type" id="type-sum"><a href="#type-sum" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('rank1, 'rank2, 'rank3, 'dim1, 'dim2, 'dim3, 'parameters) sum</code><code><span class="keyword"> = </span>[&lt; `zero of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-z">z</a><span class="keyword"> * </span><span class="type-var">'p2</span> <a href="index.html#type-one">one</a> | `one of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim2</span> | `two of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'dim2</span> ] | `one of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim1</span> | `one of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'dim2</span><span class="keyword"> * </span><span class="type-var">'dim2</span> ] | `two of <span class="type-var">'rank2</span> * [&lt; `zero of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'dim1</span> | `two of <span class="type-var">'rank3</span><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim3</span> * <span class="type-var">'p1</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'dim1</span><span class="keyword"> * </span><span class="type-var">'dim3</span> ] ]<span class="keyword"> as </span>rank1</code><code><span class="keyword"> constraint </span><span class="type-var">'parameters</span> = <span class="type-var">'p1</span><span class="keyword"> * </span><span class="type-var">'p2</span><span class="keyword"> * </span><span class="type-var">'p3</span></code></div><div class="doc"><p>(x,y,z,_ ) sum computes the rank of x + y and
put the result inside z</p></div></div><div class="spec type" id="type-cross"><a href="#type-cross" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('dim, 'res, 'parameters) cross</code><code><span class="keyword"> = </span>[&lt; `two of <span class="type-var">'res</span> * <span class="type-var">'p2</span><span class="keyword"> * </span><span class="type-var">'p1</span> <a href="index.html#type-z">z</a> | `three of <span class="type-var">'res</span> * <span class="type-var">'p2</span> <a href="index.html#type-three">three</a><span class="keyword"> * </span><span class="type-var">'p1</span> <a href="index.html#type-one">one</a> ]<span class="keyword"> as </span>dim</code><code><span class="keyword"> constraint </span><span class="type-var">'parameters</span> = <span class="type-var">'p1</span><span class="keyword"> * </span><span class="type-var">'p2</span></code></div><div class="doc"></div></div><div class="spec type" id="type-simple_sum"><a href="#type-simple_sum" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('dim1, 'dim2, 'dim3, 'p) simple_sum</code><code><span class="keyword"> = </span>[&lt; `one of <span class="type-var">'dim2</span> * [&lt; `one of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-two">two</a> | `two of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-three">three</a> | `three of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-four">four</a> ] | `two of <span class="type-var">'dim2</span> * [&lt; `one of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-three">three</a> | `two of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-four">four</a> ] | `three of <span class="type-var">'dim2</span> * [&lt; `one of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-four">four</a> ] ]<span class="keyword"> as </span>dim1</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-nat_sum"><a href="#type-nat_sum" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('dim1, 'dim2, 'dim3, 'p) nat_sum</code><code><span class="keyword"> = </span>[&lt; `one of <span class="type-var">'dim2</span> * [&lt; `one of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-two">two</a> | `two of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-three">three</a> | `three of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-four">four</a> ] | `two of <span class="type-var">'dim2</span> * [&lt; `one of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-three">three</a> | `two of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-four">four</a> ] | `three of <span class="type-var">'dim2</span> * [&lt; `one of <span class="type-var">'dim3</span> * <span class="type-var">'p</span> <a href="index.html#type-four">four</a> ] ]<span class="keyword"> as </span>dim1</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-superindexing"><a href="#type-superindexing" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>('tensor_rank, 'index_rank, 'res_rank, 'dim, 'res_dim, 'len, 'parameters) superindexing</code><code><span class="keyword"> = </span>[&lt; `two of <span class="type-var">'index_rank</span> * [&lt; `two of <span class="type-var">'len</span> * [&lt; `one of <span class="type-var">'res_rank</span> * <span class="type-var">'p</span> <a href="index.html#type-z">z</a> | `two of <span class="type-var">'res_dim</span><span class="keyword"> * </span><span class="type-var">'res_rank</span> * <span class="type-var">'s</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'p</span> <a href="index.html#type-one">one</a> | `three of <span class="type-var">'res_dim</span><span class="keyword"> * </span><span class="type-var">'res_rank</span> * <span class="type-var">'s</span> <a href="index.html#type-three">three</a><span class="keyword"> * </span><span class="type-var">'p</span> <a href="index.html#type-one">one</a> | `four of <span class="type-var">'res_dim</span><span class="keyword"> * </span><span class="type-var">'res_rank</span> * <span class="type-var">'s</span> <a href="index.html#type-four">four</a><span class="keyword"> * </span><span class="type-var">'p</span> <a href="index.html#type-one">one</a> ] | `one of <span class="type-var">'dim</span><span class="keyword"> * </span><span class="type-var">'len</span> * <span class="type-var">'res_dim</span><span class="keyword"> * </span>[&lt; `one of <span class="type-var">'res_rank</span> * <span class="type-var">'p</span> <a href="index.html#type-one">one</a> | `two of <span class="type-var">'dim</span><span class="keyword"> * </span><span class="type-var">'res_rank</span> * <span class="type-var">'p</span> <a href="index.html#type-two">two</a><span class="keyword"> * </span><span class="type-var">'s</span> <a href="index.html#type-two">two</a> | `three of <span class="type-var">'dim</span><span class="keyword"> * </span><span class="type-var">'res_rank</span> * <span class="type-var">'p</span> <a href="index.html#type-three">three</a><span class="keyword"> * </span><span class="type-var">'s</span> <a href="index.html#type-two">two</a> | `four of <span class="type-var">'dim</span><span class="keyword"> * </span><span class="type-var">'res_rank</span> * <span class="type-var">'p</span> <a href="index.html#type-four">four</a><span class="keyword"> * </span><span class="type-var">'s</span> <a href="index.html#type-two">two</a> ] ] | `one of <span class="type-var">'len</span> * [&lt; `one of <span class="type-var">'res_rank</span> * <span class="type-var">'p</span> <a href="index.html#type-z">z</a> | `two of <span class="type-var">'res_rank</span><span class="keyword"> * </span><span class="type-var">'res_dim</span> * <span class="type-var">'p</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'s</span> <a href="index.html#type-two">two</a> | `three of <span class="type-var">'res_rank</span><span class="keyword"> * </span><span class="type-var">'res_dim</span> * <span class="type-var">'p</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'s</span> <a href="index.html#type-three">three</a> | `four of <span class="type-var">'res_rank</span><span class="keyword"> * </span><span class="type-var">'res_dim</span> * <span class="type-var">'p</span> <a href="index.html#type-one">one</a><span class="keyword"> * </span><span class="type-var">'s</span> <a href="index.html#type-four">four</a> ] ]<span class="keyword"> as </span>tensor_rank</code><code><span class="keyword"> constraint </span><span class="type-var">'parameters</span> = <span class="type-var">'p</span><span class="keyword"> * </span><span class="type-var">'s</span></code></div><div class="doc"></div></div></body></html>